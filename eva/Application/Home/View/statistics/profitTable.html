<script>

$('#page a').click(function(){
	var href=$(this).attr('href');
	$.get(href, function(result){
	    $("#profit_table").html(result);
	  });
	return false;
});
$('#profitdetail tbody tr').click(function(){
	var id=$(this).attr('id');
	var sum=$('#'+id).find('td:nth-child(5)').text();
	if(sum=='0.00'){ return;}
	 var categories=new Array();
     var series = new Array();
	$.ajax({
		 type:"POST",
		 data:{inorder:id},
		 url:"__URL__/profitDetail",
		 dataType: "json",
		 async: false,
		 success: function(data){
			 categories=data.categories;
			 series=data.series;
			
		 },
	});
	// return;
	 $('#profit_chart').length && $('#profit_chart').remove();
	 var html='<div id="profit_chart" ><fieldset><div id="chart2" style="width:60%;">haha</div></fieldset></div>';
	 $('body').append(html); 
	 $('#chart2').highcharts({
	        chart: {
	            type: 'column'
	        },
	        title: {
	            text: id+"毛利明细图表"
	        },
	        xAxis: {
	            categories: categories
	        },
	        yAxis: {
	            title: {
	                text: '毛利 (元)'
	            },
	        },
	        credits: {
	            enabled: false
	        },
	        tooltip: {
	            valueSuffix: '元'
	        },
	        series: [{
	            name: '毛利',
	            data: series
	        }],
	        legend: {
	            enabled: false
	        },
	    });
	 
	 $('#profit_chart').dialog({
		 width:800,
		 maxHeight:600,
		 title:id+"毛利明细图表",
		 modal: true,
		 close:function(){$(this).remove();},
	     buttons: {
	    	 "关闭": function() { $(this).dialog( "close" ); },
	      },
	});
	 
});
</script>
<div class="clearfix" style="text-align:center"><h4>{$info}营业统计表</h4></div>
<table class="bordered" style="width:100%;font-size:12px" id="profitdetail" > 
    <thead> 
    <tr>
        <th width="13%">入库单号</th> 
    	<th>进货数量</th> 
    	<th>进货金额</th> 
    	<th>进货费用</th> 
    	<th>销售数量</th>
    	<th>销售金额</th>
    	<th>库存数量</th>
    	<th>库存金额</th>
    	<th>损耗数量</th>
    	<th>此单毛利</th>
    </tr>
    </thead>
    <tbody>
    <volist name="profit_table" id="vo">
    <tr id='{$vo.inorder}'>
    <td>{$vo.inorder}</td>
    <td>{$vo.number|number_format=2}</td>
    <td>￥{$vo.sum|number_format}</td>
    <td>￥{$vo.freight|number_format}</td>
    <td>{$vo.s_num|number_format=2}</td>
    <td>￥{$vo.s_sum|number_format}</td>
    <td>{$vo.stock|number_format=2}</td>
     <td>￥{$vo.stock_sum|number_format}</td>
     <assign name="temp_num" value="$vo['number']-$vo['s_num']"/>
     <assign name="temp_num" value="$temp_num-$vo['stock']"/>
     <if condition="$temp_num gt 0"><td><font color='#FFA500'>折称:{$temp_num|number_format=2}</font></td>
     <else />
     <td>涨称:{$temp_num|number_format=2}</td>
     </if>
      <assign name="temp_sum" value="$vo['stock_sum']+$vo['s_sum']"/>
     <assign name="temp_sum" value="$temp_sum-$vo['sum']-$vo['freight']"/>
     <if condition="$temp_sum gt 0">
     <td><font color='green'>盈:￥{$temp_sum|number_format=2}</font></td>
     <else />
     <td><font color='red'>亏:￥{$temp_sum|number_format=2}</font></td>
     </if>
    </tr>
    </volist>
    </tbody>
    </table>
     <div class="green-black" style="float:right" id="page">{$page}</div>